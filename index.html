<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>10-Minute Viral Script Engine (Gemini 1.5 + GPT-4o)</title>
    <script src="https://js.puter.com/v2/"></script>
    <style>
        :root { --yt-red: #ff0000; --bg: #0d0d0d; --card: #1a1a1a; --text: #f0f0f0; --accent: #00e676; }
        body { font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text); padding: 15px; }
        .container { max-width: 950px; margin: auto; background: var(--card); border-radius: 20px; padding: 35px; border: 1px solid #333; }
        
        #loader {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); z-index: 1000; flex-direction: column; align-items: center; justify-content: center;
        }
        .spinner { width: 50px; height: 50px; border: 5px solid #222; border-top: 5px solid var(--yt-red); border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }

        h1 { text-align: center; font-size: 24px; color: #fff; margin-bottom: 30px; }
        .engine-label { color: var(--accent); font-size: 10px; font-weight: bold; text-align: center; margin-top: -20px; margin-bottom: 25px; }
        
        label { display: block; margin-top: 15px; font-size: 12px; color: #888; text-transform: uppercase; font-weight: bold; }
        input, textarea, select { width: 100%; padding: 15px; background: #000; border: 1px solid #444; border-radius: 10px; color: #fff; margin-top: 8px; box-sizing: border-box; }

        .btn { background: var(--yt-red); color: #fff; border: none; padding: 20px; width: 100%; border-radius: 12px; font-size: 18px; font-weight: 800; cursor: pointer; margin-top: 25px; transition: 0.3s; }
        .btn:hover { background: #b30000; transform: translateY(-2px); box-shadow: 0 5px 20px rgba(255,0,0,0.3); }

        .output-container { margin-top: 40px; }
        .script-box { background: #000; padding: 25px; border-radius: 15px; border: 1px solid #444; min-height: 400px; white-space: pre-wrap; font-size: 15px; line-height: 1.7; overflow-y: auto; max-height: 800px; }
        .stats { font-size: 11px; color: #666; margin-top: 10px; display: flex; justify-content: space-between; }
    </style>
</head>
<body>

<div id="loader">
    <div class="spinner"></div>
    <p id="loader-status" style="margin-top: 20px;">Initializing AI Engines...</p>
</div>

<div class="container">
    <h1>10-Minute Script Architect</h1>
    <div class="engine-label">DUAL-CORE PROCESSING: PATTERN (GEMINI 1.5) + LOGIC (GPT-4o)</div>

    <label>Competitor Video (Highest Views Reference)</label>
    <input type="text" id="refUrl" placeholder="Link to a 1M+ view video for analysis...">

    <label>Your Topic / Core Message</label>
    <textarea id="topic" rows="3" placeholder="Explain your concept in detail..."></textarea>

    <div style="display: flex; gap: 15px;">
        <div style="flex:1">
            <label>Language Style</label>
            <select id="lang">
                <option value="Hinglish (Conversational Mix)">Hinglish (Natural Mix)</option>
                <option value="English (Global)">English</option>
                <option value="Hindi (Shuddh)">Hindi</option>
            </select>
        </div>
        <div style="flex:1">
            <label>Target Length</label>
            <select id="duration">
                <option value="1600 words (10-12 mins)">10+ Minutes (Deep Dive)</option>
                <option value="2000 words (15 mins)">15 Minutes (Masterclass)</option>
            </select>
        </div>
    </div>

    <button class="btn" onclick="generateLongScript()">ARCHITECT FULL SCRIPT</button>

    <div class="output-container">
        <label>Final Viral Script</label>
        <div id="scriptOut" class="script-box">Script will be generated here...</div>
        <div class="stats">
            <span id="wordCount">Words: 0</span>
            <span id="enginePath">Logic Flow: Ready</span>
        </div>
    </div>
</div>

<script>
    async function generateLongScript() {
        const topic = document.getElementById('topic').value;
        const refUrl = document.getElementById('refUrl').value;
        const lang = document.getElementById('lang').value;
        const len = document.getElementById('duration').value;
        const loader = document.getElementById('loader');
        const status = document.getElementById('loader-status');
        const scriptOut = document.getElementById('scriptOut');

        if (!topic) return alert("Please enter a topic!");
        loader.style.display = 'flex';
        scriptOut.innerText = "Processing...";

        try {
            // STEP 1: Gemini 1.5 Pro - Pattern Analysis
            status.innerText = "Step 1: Gemini 1.5 Pro deconstructing viral DNA...";
            const analysisResponse = await puter.ai.chat(
                `Deconstruct the viral patterns for this topic: "${topic}". 
                Reference URL: ${refUrl}. 
                Extract psychological triggers, retention loops, and a 10-point narrative arc for a 10-minute video.`, 
                { model: 'gemini-1.5-pro' } // Updated to actual existing model
            );
            const analysis = analysisResponse.toString();

            // STEP 2: GPT-4o - Long Form Expansion
            status.innerText = "Step 2: GPT-4o writing master script in " + lang + "...";
            const scriptPrompt = `You are a world-class YouTube Scriptwriter. 
            Using this analysis: [${analysis}], 
            write a full video script (approx. ${len}) for: "${topic}".
            
            LANGUAGE: ${lang}.
            CRITICAL RULES:
            1. Pattern Interrupts every 45 seconds (Visual change/Sound).
            2. Spoken, natural dialogue.
            3. Include [Visual Cues] and [B-Roll Instructions].
            4. Structure: 
               - Hook (0:45), Problem (1:15), Body (7:00), Outro (1:00).`;

            const finalScript = await puter.ai.chat(scriptPrompt, { model: 'gpt-4o' }); // Updated to existing model
            
            const text = finalScript.toString();
            scriptOut.innerText = text;
            document.getElementById('wordCount').innerText = "Words: " + text.split(/\s+/).length;
            document.getElementById('enginePath').innerText = "Logic Flow: Gemini 1.5 -> GPT-4o";

        } catch (err) {
            console.error(err);
            // Fallback attempt if specific models fail
            status.innerText = "Primary models busy. Attempting fallback...";
            try {
                const fallback = await puter.ai.chat(`Write a ${len} script about ${topic} in ${lang}.`, { model: 'gpt-4o-mini' });
                scriptOut.innerText = fallback.toString();
                document.getElementById('enginePath').innerText = "Logic Flow: Fallback (GPT-4o-mini)";
            } catch (fallbackErr) {
                alert("The models are currently overloaded. Please check your Puter.js credits or try again in a few minutes.");
            }
        } finally {
            loader.style.display = 'none';
        }
    }
</script>

</body>
</html>
