<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Viral Script Engine (Budget Friendly)</title>
    <script src="https://js.puter.com/v2/"></script>
    <style>
        :root { --yt-red: #ff0000; --bg: #0d0d0d; --card: #1a1a1a; --text: #f0f0f0; --accent: #00e676; }
        body { font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text); padding: 15px; }
        .container { max-width: 850px; margin: auto; background: var(--card); border-radius: 15px; padding: 30px; border: 1px solid #333; }
        
        #loader {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); z-index: 1000; flex-direction: column; align-items: center; justify-content: center;
        }
        .spinner { width: 50px; height: 50px; border: 5px solid #222; border-top: 5px solid var(--yt-red); border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }

        h1 { text-align: center; color: #fff; margin-bottom: 5px; }
        .engine-label { color: var(--accent); font-size: 11px; font-weight: bold; text-align: center; margin-bottom: 20px; }
        
        label { display: block; margin-top: 15px; font-size: 12px; color: #888; text-transform: uppercase; font-weight: bold; }
        input, textarea { width: 100%; padding: 12px; background: #000; border: 1px solid #444; border-radius: 8px; color: #fff; margin-top: 5px; box-sizing: border-box; }

        .btn { background: var(--yt-red); color: #fff; border: none; padding: 15px; width: 100%; border-radius: 8px; font-size: 16px; font-weight: bold; cursor: pointer; margin-top: 20px; }
        .btn-save { background: #333; margin-top: 10px; border: 1px solid #555; }
        .btn:hover { opacity: 0.9; }

        .script-box { background: #000; padding: 20px; border-radius: 10px; border: 1px solid #444; min-height: 300px; white-space: pre-wrap; font-size: 15px; line-height: 1.6; margin-top: 15px; }
    </style>
</head>
<body>

<div id="loader">
    <div class="spinner"></div>
    <p id="loader-status" style="margin-top: 20px; color: white;">AI is thinking...</p>
</div>

<div class="container">
    <h1>Script Architect</h1>
    <div class="engine-label">MODE: CASUAL HINGLISH (LOW-CREDIT MODE)</div>

    <label>Topic / Movie Name</label>
    <input type="text" id="topic" placeholder="e.g. Dhurandhar Movie Cast & Hype">

    <label>Extra Details</label>
    <textarea id="notes" rows="3" placeholder="Talk about Ranveer Singh, Aditya Dhar, and why this movie will be a hit."></textarea>

    <button class="btn" onclick="generateScript()">GENERATE SCRIPT</button>
    <button class="btn btn-save" onclick="saveToFile()">DOWNLOAD AS .TXT</button>

    <div id="scriptOut" class="script-box">Script result will appear here...</div>
</div>

<script>
    async function generateScript() {
        const topic = document.getElementById('topic').value;
        const notes = document.getElementById('notes').value;
        const loader = document.getElementById('loader');
        const scriptOut = document.getElementById('scriptOut');

        if (!topic) return alert("Bhai, topic toh likho!");
        loader.style.display = 'flex';

        try {
            // Using 'gpt-4o-mini' to avoid "Not Enough Funding" errors
            const prompt = `Write a viral YouTube script in casual Hinglish for: "${topic}". 
            Context: ${notes}.
            - Use day-to-day Delhi/Mumbai slang (Bhai, Scene, Level, Solid). 
            - NO Shuddh Hindi words. 
            - Fact-check: If about 'Dhurandhar', mention director Aditya Dhar and cast Ranveer Singh, Sanjay Dutt, Akshaye Khanna.
            - Format with [Visuals] and [Sfx].`;

            const response = await puter.ai.chat(prompt, { model: 'gpt-4o-mini' });
            scriptOut.innerText = response.toString();

        } catch (err) {
            console.error(err);
            if(err.message.includes("funding")){
                alert("Puter account credits khatam ho gaye hain. Please check Puter Dashboard.");
            } else {
                alert("Something went wrong. Try again.");
            }
        } finally {
            loader.style.display = 'none';
        }
    }

    function saveToFile() {
        const text = document.getElementById('scriptOut').innerText;
        if(text === "Script result will appear here...") return alert("Pehle script generate karo!");
        
        const blob = new Blob([text], { type: 'text/plain' });
        const anchor = document.createElement('a');
        anchor.download = 'youtube_script.txt';
        anchor.href = window.URL.createObjectURL(blob);
        anchor.click();
    }
</script>

</body>
</html>
